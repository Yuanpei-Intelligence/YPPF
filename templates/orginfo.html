{% extends "base.html" %}

{% block mainpage %}

<div class="main-content" id="content">

    <!--  BEGIN CONTENT AREA  -->

    {% if html_display.warn_code == 2 %}
    <div class="alert alert-success text-center mb-0">{{html_display.warn_message}}</div>
    {% elif html_display.warn_code == 1%}
    <div class="alert alert-warning text-center mb-0">{{html_display.warn_message}}</div>
    {% endif %}

    <!--  BEGIN SWITCH TAB  -->
    <ul class="nav nav-tabs nav-tabs-solid nav-justified" role="tablist">
        <li class="nav-item">
            <b class="nav-link active" data-toggle="tab" role="tab" href="#organization_info">组织信息</b>
        </li>
        <li class="nav-item">
            <b class="nav-link" data-toggle="tab" role="tab" href="#member_info">成员信息</b>
        </li>
        <li class="nav-item">
            <b class="nav-link" data-toggle="tab" role="tab" href="#activity">组织活动</b>
        </li>
    </ul>
    <!--  END SWITCH TAB  -->

    <div class="container-fluid tab-content" id="myTabContent">
        <!--  BEGIN INFORMATION TAB  -->
        <div class="tab-pane fade show active" id="organization_info" role="tabpanel">
            <div class="col layout-top-spacing">

                <div class="user-profile layout-spacing">
                    <div class="widget-content widget-content-area">

                        <div class="d-flex justify-content-between">
                            <h3 class="">组织信息</h3>
                            <br /><br />
                        </div>

                        <div class="text-center user-info">
                            <img src={{ org_avatar_path }} height="90px" width="90px" alt="avatar">
                            <p class="">{{ organization_name }}</p>

                            {% if show_subscribe %}
                            <div class="custom-control custom-switch">
                                {% if subscribe_flag %}
                                <input type="checkbox" class="custom-control-input" id="switch button"
                                    onclick="change_status.call(this);this.blur();" checked>
                                <label class="custom-control-label" for="switch button">
                                    <font color="5F747B" id="subscribe">已订阅</font>
                                </label>
                                {% else %}
                                <input type="checkbox" class="custom-control-input" id="switch button"
                                    onclick="change_status.call(this);this.blur();">
                                <label class="custom-control-label" for="switch button">
                                    <font color="E1E1E1" id="subscribe">未订阅</font>
                                </label>
                                {% endif %}
                            </div>
                            {% endif %}
                        </div>

                        <div class="user-info-list">
                            <div class="">
                                <ul class="contacts-block list-unstyled">

                                    <li class="contacts-block__item">
                                        <!-- at-sign -->
                                        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor"
                                            stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"
                                            class="css-i6dzq1">
                                            <circle cx="12" cy="12" r="4"></circle>
                                            <path d="M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-3.92 7.94"></path>
                                        </svg>
                                        {{ organization_type_name }}
                                    </li>

                                    <li class="contacts-block__item">
                                        <!-- at-sign -->
                                        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor"
                                            stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"
                                            class="css-i6dzq1">
                                            <circle cx="12" cy="12" r="4"></circle>
                                            <path d="M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-3.92 7.94"></path>
                                        </svg>
                                        元气值{{org.YQPoint}}
                                    </li>

                                    {% if html_display.is_myself == False %}
                                    <li class="contacts-block__item">
                                        <!-- at-sign -->
                                        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor"
                                            stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"
                                            class="css-i6dzq1">
                                            <circle cx="12" cy="12" r="4"></circle>
                                            <path d="M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-3.92 7.94"></path>
                                        </svg>
                                        <a href="/transPage/{{ org.organization_id_id }}">向ta转账</a>
                                    </li>
                                    {% endif %}

                                    {% if html_display.is_myself == False %}
                                    <li class="contacts-block__item">
                                        <!-- at-sign -->
                                        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor"
                                            stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"
                                            class="css-i6dzq1">
                                            <circle cx="12" cy="12" r="4"></circle>
                                            <path d="M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-3.92 7.94"></path>
                                        </svg>
                                        <a href="/applyPosition/{{org.organization_id_id}}">我要加入</a>
                                    </li>
                                    {% endif %}

                                </ul>
                            </div>
                        </div>

                        <div class="d-flex justify-content-between">
                            <h3 class="">组织简介</h3>
                            <br /><br />
                        </div>
                        <p>{{org.introduction}}</p>
                        <br />
                    </div>
                </div>
            </div>

        </div>
        <!--  END INFORMATION TAB  -->

        <!--  BEGIN MEMBER TAB  -->
        <div class="tab-pane fade" id="member_info" role="tabpanel">

            <div class="layout-px-spacing layout-top-spacing">
                <div class="bio layout-spacing">

                    <!--  BEGIN MEMBERS -->
                    <div class="widget-content widget-content-area my-3">

                        <div class="row">
                            <h3 class="col mb-0">成员档案</h3>
                        </div>


                        <div class="bio-skill-box">

                            <div class="row">
                                {% for member in member_list %}
                                <div class="col-12 col-xl-6 col-lg-12 mb-xl-4 mb-4 ">
                                    <div class=" b-skills" style="padding: 5%;">

                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <h5>
                                                    <img src={{ member.avatar_path }} width="24" height="24"
                                                        alt="avatar">
                                                    <a href='/stuinfo/{{ member.person.name }}'>
                                                        <u>{{ member.person.name }}</u>
                                                    </a>
                                                </h5>
                                            </div>
                                            <div>
                                                <h5>
                                                    {% if member.highest %}
                                                    <i class="fa fa-user-circle"></i>
                                                    {% else %}
                                                    <i class="fa fa-user"></i>
                                                    {% endif %}
                                                    {{ member.job }}
                                                </h5>
                                            </div>
                                        </div>

                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <p style="color: rgb(66, 67, 68);">{{ member.person.stu_grade }}级
                                                </p>
                                            </div>
                                            <div>
                                                {% if member.person.show_major %}
                                                <p style="color: rgb(66, 67, 68);">{{ member.person.stu_major }}</p>
                                                {% else %}
                                                <p style="color: rgb(66, 67, 68);">专业未公开</p>
                                                {% endif %}
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                {% endfor %}
                            </div>
                        </div>

                    </div>
                    <!--  END MEMBERS  -->

                    <!--  BEGIN HIDDEN MEMBERS  -->
                    {% if html_display.is_myself == True %}
                    <div class="widget-content widget-content-area my-3">

                        <div class="row">
                            <h3 class="col mb-0">隐藏的成员</h3>
                        </div>

                        <div class="bio-skill-box">

                            {% if html_display.hidden_orgs_info is None %}
                            <p style="text-align: center;">没有隐藏的成员</p>
                            {% else %}
                            <!-- <div class="row">
                                {% for org, ava, pos, status in html_display.hidden_orgs_info %}
                                <div class="col-12 col-xl-6 col-lg-12 mb-xl-4 mb-4 ">
                                    <div
                                        style="padding-left: 2%;padding-right: 2%; background-image: url({{ ava }}); background-size: 55%; background-repeat: no-repeat; background-position: right;">
                                        <div class=" b-skills row" style="background-color: #ffffffcc;">
                                            <div class="col-9 container-fluid">
                                                <a href="/orginfo/{{ org.oname }}">
                                                    <h5>{{ org.oname }}</h5>
                                                </a>
                                                <p
                                                    style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                                    {{ org.introduction }}</p>
                                            </div>
                                            <div class="col-3 pr-0">
                                                <p>职务 <b class="text-muted">{{ pos }}</b></p>
                                                <p>状态 <b class="text-muted">{{ status }}</b></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}

                            </div> -->
                            {% endif %}
                        </div>

                    </div>
                    {% endif %}
                    <!--  END HIDDEN MEMBERS  -->

                </div>
            </div>

        </div>
        <!--  END MEMBER TAB  -->

        <!--  BEGIN ACTIVITY TAB  -->
        <div class="tab-pane fade" id="activity" role="tabpanel">
            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 layout-top-spacing">
                <div class="bio layout-spacing ">
                    <div class="widget-content widget-content-area">

                        <h3 class="">活动档案</h3>

                        <ul id="myTab" class="nav nav-tabs nav-tabs-solid nav-justified">
                            <li class="nav-item">
                                <a class="nav-link active" href="#act0" data-toggle="tab">
                                    未结束
                                </a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link" href="#act1" data-toggle="tab">
                                    已结束
                                </a>
                            </li>

                        </ul>

                        <div class="tab-content">

                            <div id="act0" class="tab-pane active">
                                <div class="bio-skill-box">
                                    {% if continuing_activity_list_participantrec|length == 0 %}
                                    <br />
                                    <p style="text-align: center;">没有该类别的活动</p>
                                    <br />
                                    {% endif %}
                                    <div class="row">
                                        {% for rec in continuing_activity_list_participantrec %}
                                        <div class="col-12 col-xl-4 col-lg-6 mb-xl-5 mb-5 ">
                                            <a href="/viewActivity/{{ rec.act.id }}">
                                                <div class="d-flex b-skills">
                                                    <div class="text-nowrap"
                                                        style='overflow: hidden;text-overflow: ellipsis;'>
                                                        <div class="d-flex justify-content-between">
                                                            <h5
                                                                style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                                                <!--一个判断：
                                                                        进行中：
                                                                            组织：success
                                                                            个人：本身的状态/报名截止（primary/danger)
                                                                        报名中：
                                                                            组织：success
                                                                            个人：其他状态/未报名（primary/danger/secondary）
                                                                        等待中：
                                                                            组织：info
                                                                            个人：本身的状态/报名截止（primary/danger)
                                                                        审核中：都是warning
                                                                    -->

                                                                {% if rec.act.status == "审核中" %}
                                                                <span class="badge badge-pill badge-warning">
                                                                    {{ rec.act.status }}
                                                                </span>
                                                                {% else %}
                                                                {% if user_type == "Organization" %}
                                                                {% if rec.act.status == "等待中" %}
                                                                <span class="badge badge-pill badge-info">
                                                                    {{ rec.act.status }}
                                                                </span>
                                                                {% else %}
                                                                <span class="badge badge-pill badge-success">
                                                                    {{ rec.act.status }}
                                                                </span>
                                                                {% endif %}
                                                                {% else %}

                                                                {% if rec.status == "无记录" %}
                                                                {% if rec.act.status == "报名中" %}
                                                                <span
                                                                    class="badge badge-pill badge-secondary">未报名</span>
                                                                {% else %}
                                                                <span class="badge badge-pill badge-danger">报名截止</span>
                                                                {% endif %}
                                                                {% elif rec.status == "申请失败" or rec.status == "未参与" or
                                                                rec.status == "取消" %}
                                                                <span class="badge badge-pill badge-primary">
                                                                    {{ rec.status }}
                                                                </span>
                                                                {% else %}
                                                                <span class="badge badge-pill badge-primary">
                                                                    {{ rec.status }}
                                                                </span>
                                                                {% endif %}

                                                                {% endif %}
                                                                {% endif %}

                                                                {{rec.act.title}}

                                                            </h5>
                                                        </div>

                                                        <p>{{ rec.act.introduction }}</p>

                                                        <div class="d-flex justify-content-start">
                                                            <p class="flex mr-3" style="width: 20px;">
                                                                <i class="fa fa-clock"></i>
                                                            </p>
                                                            <p class="flex">
                                                                {{ rec.act.start }}
                                                            </p>
                                                        </div>

                                                        <div class="d-flex justify-content-start">
                                                            <p class="flex mr-3" style="width: 20px;">
                                                                <i class="fa fa-users"></i>
                                                            </p>
                                                            <p class="flex">
                                                                {{ rec.act.current_participants }}
                                                                /
                                                                {{ rec.act.capacity }}
                                                            </p>
                                                        </div>

                                                        <div class="row">
                                                            <div class="col d-flex justify-content-start">
                                                                <p class="flex mr-3" style="width: 20px;">
                                                                    <i class="fa fa-money-bill"></i>
                                                                </p>
                                                                <p class="flex">
                                                                    {{ rec.act.YQPoint }}
                                                                </p>
                                                            </div>

                                                            <div class="col d-flex justify-content-start">
                                                                <p class="flex mr-3" style="width: 20px;">
                                                                    <i class="fa fa-location-arrow"></i>
                                                                </p>
                                                                <p class="flex">
                                                                    {{ rec.act.location }}
                                                                </p>
                                                            </div>
                                                        </div>

                                                    </div>

                                                    <!-- 加入/退出的按钮
                                                        {% if html_display.is_myself == True %}
                                                            <div class="text-right">
                                                                <a href="/welcome/" class="btn btn-primary btn-sm" role="button">管理</a>
                                                            </div>
                                                        {% elif user_type == "Person" %}
                                                            <div class="text-right">
                                                                {% if rec.act.status == "报名中" %}
                                                                    {% if rec.status == "申请中" or rec.status == "已报名" or rec.status == "已参加" %}
                                                                        <a href="/welcome/" class="btn btn-primary btn-sm" role="button">退出</a>
                                                                    {% elif rec.status == "无记录" %}
                                                                        <a href="/welcome/" class="btn btn-primary btn-sm" role="button">加入</a>
                                                                    {% endif %}
                                                                {% elif rec.act.status != "审核中" %}
                                                                    {% if rec.status == "申请中" or rec.status == "已报名" or rec.status == "已参加" %}
                                                                        <a href="/welcome/" class="btn btn-primary btn-sm" role="button">退出</a>
                                                                    {% endif %}
                                                                {% endif %}
                                                            </div>
                                                        {% endif %}
                                                        -->

                                                </div>
                                            </a>
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            <div id="act1" class="tab-pane fade">
                                <div class="bio-skill-box ">
                                    {% if ended_activity_list_participantrec|length == 0 %}
                                    <br />
                                    <p style="text-align: center;">没有该类别的活动</p>
                                    <br />
                                    {% endif %}
                                    <div class="row">
                                        {% for rec in ended_activity_list_participantrec %}
                                        <div class="col-12 col-xl-4 col-lg-6 mb-xl-5 mb-5 ">
                                            <a href="/viewActivity/{{rec.act.id}}">
                                                <div class="d-flex b-skills">
                                                    <div class="text-nowrap"
                                                        style='overflow: hidden;text-overflow: ellipsis;'>
                                                        <div class="d-flex justify-content-between">
                                                            <h5>{{rec.act.title}}
                                                                {% if user_type == "Person" and rec.status == "已参与" %}
                                                                <span class="badge badge-pill badge-primary">已参与</span>
                                                                {% elif user_type == "Person" and rec.status == "未参与" %}
                                                                <span
                                                                    class="badge badge-pill badge-secondary">未参与</span>
                                                                {% else %}
                                                                <span
                                                                    class="badge badge-pill badge-danger">{{rec.act.status}}</span>
                                                                {% endif %}
                                                            </h5>
                                                        </div>

                                                        <p>{{rec.act.introduction}}</p>
                                                        <p>报名结束时间： {{rec.act.endbefore}}</p>
                                                        <p>活动开始时间： {{rec.act.start}}</p>
                                                        <p>已报名/最大人数：{{rec.act.current_participants}}/{{rec.act.capacity}}
                                                        </p>
                                                        <div class="row">
                                                            <div class="col">
                                                                <p>价格：{{rec.act.YQPoint}}</p>
                                                            </div>
                                                            <div class="col">
                                                                <p>地点：{{rec.act.location}}</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </a>
                                        </div>
                                        {% endfor %}

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--  END ACTIVITY TAB  -->

    </div>
    <!--  END CONTENT AREA  -->

</div>
{% endblock %}