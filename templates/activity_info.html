{% extends "base.html" %}

{% load static %}

{% block mainpage %}
<!--  BEGIN MAIN CONTAINER  -->
<div class="main-container" id="container">

    <div class="overlay"></div>
    <div class="search-overlay"></div>

    {% if user_type == "Person" %}
        {% include 'user_left_narbar.html' %}
    {% else %}
        {% include 'org_left_narbar.html' %}
    {% endif %}

    <!--  BEGIN CONTENT AREA  -->
    <div id="content" class="main-content">

        {% if html_display.warn_code == 1 %}
        <div class="alert alert-warning  text-center" >{{ html_display.warn_message }}</div>
        {% elif html_display.warn_code == 2 %}
        <div class="alert alert-success  text-center" >{{ html_display.warn_message }}</div>
        {% endif %}

        <div class="container">
            <div class="container">

                <!--<div id="navSection" data-spy="affix" class="nav  sidenav">
                        <div class="sidenav-content">
                            <a href="#custom_carousel" class="active nav-link">Custom Carousel</a>
                            <a href="#slides_only" class="nav-link">Slides only</a>
                            <a href="#with_controls" class="nav-link">With controls</a>
                            <a href="#with_indicators" class="nav-link">With indicators</a>
                            <a href="#with_captions" class="nav-link">With captions</a>
                        </div>
                    </div> -->
                <div class="row ">
                    <!--  活动照片展示模块  -->
                    <div class="col-lg-12 col-md-12 mb-5 p-0">
                        <div id="style1" class="carousel slide style-custom-1" data-ride="carousel">
                             <ol class="carousel-indicators">
                                <li data-target="#style1" data-slide-to="0" class="active"></li>
                                <li data-target="#style1" data-slide-to="1"></li>
                                <li data-target="#style1" data-slide-to="2"></li>
                            </ol> 
                            <div class="carousel-inner">
                                <div class="carousel-item active">
                                    <img class="d-block w-100 slide-image" id="0" src={% static "assets/img/1.jpeg.jpg" %} alt="First slide">
                                </div>
                                <div class="carousel-item">
                                    <img class="d-block w-100 slide-image" id="1" src={% static "assets/img/1.jpeg.jpg" %} alt="Second slide">
                                </div>
                                <div class="carousel-item">
                                    <img class="d-block w-100 slide-image" id="2" src={% static "assets/img/1.jpeg.jpg" %} alt="Third slide">
                                </div>
                            </div>
                             <a class="carousel-control-prev" href="#style1" role="button" data-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Previous</span>
                            </a>
                            <a class="carousel-control-next" href="#style1" role="button" data-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Next</span>
                            </a> 
                        </div>
                    </div>
                </div>
                <div class="row layout-top-spacing">

                        <div class="col-xl-8 col-lg-6 col-md-7 col-sm-12 layout-top-spacing">
    
                            <div class="col-lg-12 col-md-12 mb-5 p-0">
                                <div class="statbox widget box box-shadow">
    
                                    <div class="widget-header">
                                        <div class="row">
                                            <div class="col-xl-12 col-md-12 col-sm-12 col-12">
                                                <h4>活动详细介绍</h4>
                                            </div>
                                        </div>
                                    </div>
        
                                    <div class="widget-content widget-content-area  style-custom-1">
        
                                        <!--  活动信息  -->
                                        <div class="code-section-container show-code">
        
                                            <h4>{{title}}
                                                {% if status == "审核中" %}
                                                <span class="badge badge-pill badge-warning">审核中</span> 
                                                {% elif status == "等待中" %}
                                                <span class="badge badge-pill badge-info">等待中</span>
                                                {% else %}
                                                <span class="badge badge-pill badge-success">{{status}}</span>
                                                {% endif %}
                                            </h4>
                                            <p class="font-weight-light"><h5>{{org_name}}</h5></p><br/>
                                            <div class="media-body">
                                                <p class="meta-time">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                                        viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                        class="feather feather-calendar">
                                                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                                        <line x1="16" y1="2" x2="16" y2="6"></line>
                                                        <line x1="8" y1="2" x2="8" y2="6"></line>
                                                        <line x1="3" y1="10" x2="21" y2="10"></line>
                                                    </svg>
                                                    活动时间：{{start_time}} —— {{end_time}}
                                                </p>
                                                <p class="meta-time">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                                        viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                        <path d="M18.36 6.64a9 9 0 1 1-12.73 0" />
                                                        <line x1="12" y1="2" x2="12" y2="12" />
                                                    </svg>
                                                    报名截止时间：{{apply_deadline}}
                                                </p>
                                                <p>
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                                                stroke-linejoin="round">
                                                                <line x1="12" y1="1" x2="12" y2="23" />
                                                                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
                                                    </svg>
                                                    {% if bidding %}
                                                        投点基础价格：{{price}}
                                                    {% else %}
                                                        元气值定价：{{price}}
                                                    {% endif %}
                                                </p>
                                               
                                                <p> 
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                                        viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                        stroke-width="2" stroke-linecap="round"stroke-linejoin="round">
                                                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                                                        <circle cx="9" cy="7" r="4" />
                                                        <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                                                        <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                                                    </svg>
                                                    已报名/人数上限: {{current_participants}}/{{capacity}}
                                                </p>
                                                <p>
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                                        viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                        <circle cx="12" cy="12" r="10" />
                                                        <line x1="2" y1="12" x2="22" y2="12" />
                                                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
                                                    </svg>
                                                    <a href="{{aURL}}"><abbr title = "link">跳转至活动链接</abbr></a>
                                                </p>
                                                <br/>
                                                <p>
                                                    {{introduction}}
                                                </p>
                                                <br/>
                                            </div>
        
                                            <!--  按钮部分  -->
                                            <div>
                                            {% if person %}
                                                {% if pStatus == -1 and status == "报名中" and bidding == True %}
                                                <button class="btn btn-primary btn-block mb-4 mr-2" data-toggle="collapse" data-target="#extend-area">
                                                    立即报名
                                                </button>
                                                {% elif pStatus == -1 and status == "报名中" and bidding == False %}
                                                <form method="POST">
                                                    <input type="hidden" name="option" value="apply">
                                                    <input type="hidden" name="aid" value={{aid}}>
                                                    <button class="btn btn-primary btn-block mb-4 mr-2">立即报名</button>
                                                </form>
                                                {% elif pStatus == -1 and status != "审核中" %}
                                                <a href="javascript:void(0);" class="btn btn-danger btn-block mb-4 mr-2">报名截止</a>
                                                {% elif pStatus == 0 %}
                                                <a href="javascript:void(0);" class="btn btn-secondary btn-block mb-4 mr-2">申请中</a>
                                                <form method="POST">
                                                    <input type="hidden" name="option" value="quit">
                                                    <input type="hidden" name="aid" value={{aid}}>
                                                    <button class="btn btn-danger btn-block mb-4 mr-2">退出活动</button>
                                                </form>
                                                {% elif pStatus == 1 %}
                                                <a href="javascript:void(0);" class="btn btn-danger btn-block mb-4 mr-2">申请失败</a>
                                                {% elif pStatus == 2 %}
                                                <a href="javascript:void(0);" class="btn btn-primary btn-block mb-4 mr-2">已报名</a>
                                                <form method="POST">
                                                    <input type="hidden" name="option" value="quit">
                                                    <input type="hidden" name="aid" value={{aid}}>
                                                    <button class="btn btn-danger btn-block mb-4 mr-2">退出活动</button>
                                                </form>
                                                {% elif pStatus == 3 %}
                                                <a href="javascript:void(0);" class="btn btn-primary btn-block mb-4 mr-2">已参与</a>
                                                {% elif pStatus == 4 %}
                                                <a href="javascript:void(0);" class="btn btn-warning btn-block mb-4 mr-2">未参与</a>
                                                {% elif pStatus == 5 %}
                                                <a href="javascript:void(0);" class="btn btn-danger btn-block mb-4 mr-2">已退出</a>
                                                {% endif %}
                                            {% elif ownership %}
                                            <form method="POST">
                                                <input type="hidden" name="option" value="edit">
                                                <input type="hidden" name="aid" value={{aid}}>
                                                <button class="btn btn-primary btn-block mb-4 mr-2">修改信息</button>
                                            </form>
                                            <form method="POST">
                                                <input type="hidden" name="option" value="payment">
                                                <input type="hidden" name="aid" value={{aid}}>
                                                <button class="btn btn-primary btn-block mb-4 mr-2">申请报销</button>
                                            </form>
                                            <form method="POST">
                                                <input type="hidden" name="option" value="cancel">
                                                <input type="hidden" name="aid" value={{aid}}>
                                                <button class="btn btn-danger btn-block mb-4 mr-2">取消活动</button>
                                            </form>
                                            {% endif %}
                                            </div>
    
                                            <!--  如果要投点报名，则展示下面的部分  -->
                                            <div id="extend-area" class="collapse">
                                                <form method="POST">
                                                    <input type="hidden" name="option" value="apply">
                                                    <input type="hidden" name="aid" value={{aid}}>
                                                    <p>意愿投点的点数(您的现有元气值：{{me.YQPoint}})</p>
                                                    <input type="number" class="form-control"
                                                            aria-label="Text input with dropdown button" id="willingness"
                                                            name="willingness" placeholder="最小精度为0.1" step="0.1"
                                                            οnkeyup="value=value.replace(/^\D*(\d*(?:\.\d{0,1})?).*$/g, '$1')">
                                                    <br/>
                                                    <button class="btn btn-primary btn-block mb-4 mr-2">确认报名</button>
                                                </form>
                                            </div>
    
                                        </div>
        
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 mb-5 p-0">
                                <a href="/orginfo/{{org_name}}">
                                    <div class="statbox widget box box-shadow">
                                        <div class="widget-header">
                                            <div class="row">
                                                <div class="col-xl-12 col-md-12 col-sm-12 col-12">
                                                    <h4>组织者</h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="widget-content widget-content-area">
                                            <div class="media">
                                                <div class="media-body">
                                                    <h4>{{org_name}} - {{org_type}}</h4>
                                                    <p>{{org.introduction}}</p>      
                                                </div>
                                                <img src="{{org_avatar_path}}" height="60px" width="60px" alt="avatar">
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </div>
    
                        </div>
                        
                        <!--  二维码展示模块  -->
                        <div class="col-xl-4 col-lg-6 col-md-5 col-sm-12 layout-top-spacing">
                            <div class="container">
                                <div class="row col-lg-12 col-md-12 mb-5 p-0">
                                <div class="statbox widget box box-shadow">
                                    <div class="widget-header">
                                        <div class="row">
                                            <div class="col-xl-12 col-md-12 col-sm-12 col-12">
                                                <h4>二维码</h4>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="widget-content widget-content-area">
                                        <img class="d-block w-100" id="qrcode" src={% static "assets/img/1.jpeg.jpg" %} alt="Third slide">
                                    </div>
                                </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <!--  END CONTENT AREA  -->

</div>
<!-- END MAIN CONTAINER -->

{% endblock %}